
<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="index, follow" />

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="/theme/stylesheet/style.min.css">


    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
          href="/theme/pygments/github.min.css">

    <script src="/theme/tipuesearch/jquery.min.js"></script>
    <script src="/theme/tipuesearch/tipuesearch.min.js"></script>
    <script src="/theme/tipuesearch/tipuesearch.min.js"></script>
    <script src="/theme/tipuesearch/tipuesearch_set.min.js"></script>
    <script src="/tipuesearch_content.js"></script>
    <link rel="stylesheet" href="/theme/tipuesearch/tipuesearch.min.css" />

  <link rel="stylesheet" type="text/css" href="/theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="/theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="/theme/font-awesome/css/solid.css">


    <link href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="R08UST's Blog Atom">


    <link rel="shortcut icon" href="/images/profile/Favicon.ico" type="image/x-icon">
    <link rel="icon" href="/images/profile/Favicon.ico" type="image/x-icon">

  
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8EL1GE1H84"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-8EL1GE1H84');
</script>
<!-- End of Global site tag (gtag.js) - Google Analytics -->
    <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#333">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#333">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Microsoft EDGE -->
    <meta name="msapplication-TileColor" content="#333">

<meta name="author" content="R08UST" />
<meta name="description" content="Introduction 在zeroWall一文中, 已经简单介绍了利用机器学习辅助Waf的方法. 实际上zeroWall一文所述的领域即网络攻击检测(web attack dection). 这里简述一些阅读过的但整体方法不够有启发性或实验不够solid的论文. Anomaly-Based Web Attack Detection: A Deep Learning Approach 本文认为一组URL可以规范化为如下形式, 即abs_path表示资源地址, 而query总是跟在&#34;?&#34; 标记之后 &#34;http:&#34; &#34;//&#34; host [ &#34;:&#34; port ] [ abs_path [ &#34;?&#34; query ]] 首先将一组URL经过序列化后分为两个部分: URL本身(图中表示为全部URL, 但按照文章所表述的URL Path 应该不含query部分)以及Query部分, 见图1. 随后将两组数据经过分词之后分别传入两个RNN结构(两层的GRU或LSTM)的神经网络以及计算其异常概率, 最后将所有的输出汇总(文中并未给出使用何种方式汇总两组RNN给出的多组异常概率)并输出给一MLP层作为最终的异常概率. 见图二 实验环节, 本文使用HTTP CISC数据集进行测试, 其结果如图三所示 结论 基于有监督的异常检测的泛化性是一个比较严重的问题, 而且本文因为工作量的较大原因仅处理了HTTP GET的请求 …" />
<meta name="keywords" content="">


<meta property="og:site_name" content="R08UST's Blog"/>
<meta property="og:title" content="论文笔记集 DeepLearning for Web Attack Detection"/>
<meta property="og:description" content="Introduction 在zeroWall一文中, 已经简单介绍了利用机器学习辅助Waf的方法. 实际上zeroWall一文所述的领域即网络攻击检测(web attack dection). 这里简述一些阅读过的但整体方法不够有启发性或实验不够solid的论文. Anomaly-Based Web Attack Detection: A Deep Learning Approach 本文认为一组URL可以规范化为如下形式, 即abs_path表示资源地址, 而query总是跟在&#34;?&#34; 标记之后 &#34;http:&#34; &#34;//&#34; host [ &#34;:&#34; port ] [ abs_path [ &#34;?&#34; query ]] 首先将一组URL经过序列化后分为两个部分: URL本身(图中表示为全部URL, 但按照文章所表述的URL Path 应该不含query部分)以及Query部分, 见图1. 随后将两组数据经过分词之后分别传入两个RNN结构(两层的GRU或LSTM)的神经网络以及计算其异常概率, 最后将所有的输出汇总(文中并未给出使用何种方式汇总两组RNN给出的多组异常概率)并输出给一MLP层作为最终的异常概率. 见图二 实验环节, 本文使用HTTP CISC数据集进行测试, 其结果如图三所示 结论 基于有监督的异常检测的泛化性是一个比较严重的问题, 而且本文因为工作量的较大原因仅处理了HTTP GET的请求 …"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="/drafts/dl4waf.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2021-03-20 00:00:00+08:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="/author/r08ust.html">
<meta property="article:section" content="AIForSecurity"/>
<meta property="og:image" content="/images/profile/profile.jpg">

  <title>R08UST's Blog &ndash; 论文笔记集 DeepLearning for Web Attack Detection</title>

</head>
<body class="light-theme">
  <aside>
    <div>
      <a href="">
        <img src="/images/profile/profile.jpg" alt="" title="">
      </a>

      <h1>
        <a href=""></a>
      </h1>

<p>Security & AI Developer</p>
        <form class="navbar-search" action="/search.html" role="search">
          <input type="text" name="q" id="tipue_search_input" placeholder="Search...">
        </form>


      <ul class="social">
          <li>
            <a  class="sc-linkedin" href="https://www.linkedin.com/in/%E5%AE%B6%E7%90%AA-%E8%92%8B-171328175/" target="_blank">
              <i class="fab fa-linkedin"></i>
            </a>
          </li>
          <li>
            <a  class="sc-github" href="https://github.com/r08ust" target="_blank">
              <i class="fab fa-github"></i>
            </a>
          </li>
      </ul>
    </div>

  </aside>
  <main>

    <nav>
      <a href="">Home</a>

      <a href="/index.html">MainPage</a>
      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>

      <a href="/feeds/all.atom.xml">Atom</a>

    </nav>

<article class="single">
  <header>
      
    <h1 id="dl4waf">论文笔记集 DeepLearning for Web Attack Detection</h1>
    <p>
      Posted on Sat 20 March 2021 in <a href="/category/aiforsecurity.html">AIForSecurity</a>

        &#8226; 1 min read
    </p>
  </header>


  <div>
    <h2>Introduction</h2>
<p>在zeroWall一文中, 已经简单介绍了利用机器学习辅助Waf的方法. 实际上zeroWall一文所述的领域即网络攻击检测(web attack dection). 这里简述一些阅读过的但整体方法不够有启发性或实验不够solid的论文. </p>
<h2><a href="https://www.semanticscholar.org/paper/Anomaly-Based-Web-Attack-Detection%3A-A-Deep-Learning-Liang-Zhao/4a05171f31fee07b8d0a04dc77baca0abb908756">Anomaly-Based Web Attack Detection: A Deep Learning Approach</a></h2>
<p>本文认为一组URL可以规范化为如下形式, 即abs_path表示资源地址, 而query总是跟在"?" 标记之后</p>
<div class="highlight"><pre><span></span><code><span class="err">"http:" "//" host [ ":" port ] [ abs_path [ "?" query ]]</span>
</code></pre></div>
<p>首先将一组URL经过序列化后分为两个部分: URL本身(图中表示为全部URL, 但按照文章所表述的URL Path 应该不含query部分)以及Query部分, 见图1. </p>
<p><img alt="图一" src="/images/AIForSecurity/tokenExample.jpg"/></p>
<p>随后将两组数据经过分词之后分别传入两个RNN结构(两层的GRU或LSTM)的神经网络以及计算其异常概率, 最后将所有的输出汇总(文中并未给出使用何种方式汇总两组RNN给出的多组异常概率)并输出给一MLP层作为最终的异常概率. 见图二</p>
<p><img alt="图二" src="https://d3i71xaburhd42.cloudfront.net/4a05171f31fee07b8d0a04dc77baca0abb908756/2-Figure1-1.png"/></p>
<p>实验环节, 本文使用<a href="https://www.isi.csic.es/dataset/">HTTP CISC数据集</a>进行测试, 其结果如图三所示</p>
<p><img alt="图三" src="https://d3i71xaburhd42.cloudfront.net/4a05171f31fee07b8d0a04dc77baca0abb908756/5-Table4-1.png"/></p>
<h3>结论</h3>
<p>基于有监督的异常检测的泛化性是一个比较严重的问题, 而且本文因为工作量的较大原因仅处理了HTTP GET的请求, 在网络攻击中POST等其他提交数据的请求同样是十分危险的. 实验环节, 仅在一个较小的数据集上进行了处理,同时实验细节的讲述也比较含糊.
当然本文也提出了一些比较有意思的观点: 本文认为将一个URL请求视为时间序列, 字符的顺序位置都会对异常检测有所帮助, 比如"id=1/<em>union</em>/union/<em>select</em>/select+1,2,3/*i" 很明显是一个sql注入, 因为ID一般都接受一个数字符号. 但对于这一点作者并未详细论证, 直接使用了RNN对这一"特征"进行了统一建模. 如果对这一点进行深入研究, 将其作为辅助特征再次插入特征集合, 应该会有很好的效果</p>
<h2><a href="https://iyatomi-lab.info/sites/default/files/user/CSPA2018%20Proceedings_ito.pdf">Web Application Firewall using Character-level Convolutional Neural Network</a></h2>
<p>本文基于CLCNN(Character Level CNN)对异常的HTTP请求进行识别. 首先将原始的HTTP请求使用URL Decode, 随后将解码后的URL请求用0填充指1000bytes的长度/裁剪至1000. 随后利用词嵌入将其表示为128维的向量, 最后利用一维卷积和全连接输出其异常概率. 见图四</p>
<p><img alt="图四" src="https://d3i71xaburhd42.cloudfront.net/36e309d7f8112c5d9ee619ad0e93d74ca6c97412/2-Figure2-1.png"/></p>
<p>实验环节, 本文使用<a href="https://www.isi.csic.es/dataset/">HTTP CISC数据集</a>进行测试, 其结果如图五所示</p>
<p><img alt="图五" src="https://d3i71xaburhd42.cloudfront.net/36e309d7f8112c5d9ee619ad0e93d74ca6c97412/4-TableIII-1.png"/></p>
<h3>结论</h3>
<p>与上一篇文章相同基于有监督的机器学习对异常请求进行处理, 其主要问题也与上一篇问题类似. 相对而言这篇论文比较重要的一点是每条请求使用该模型处理只需要2.4ms. 处理速度对于Wad这一问题是很重要的, 但其他文章都很少提及这一点.</p>
<h2><a href="https://netman.aiops.org/~peidan/ANM2019/13.Security/ReadingLists/2017ICONIP_CNN.pdf">A Deep Learning Method to Detect WebAttacks Using a Specially Designed CNN</a></h2>
<p>本文与Web Application Firewall using Character-level Convolutional Neural Network一文类似, 都使用CLCNN网络结构处理HTTP Request. 但细节上本文, 将URL Request进行了分词处理, 随后将经过词嵌入的各个词向量进行卷积以及拼接, 最后交由MLP进行输出处理. 见图六</p>
<p><img alt="图六" src="https://media.springernature.com/lw785/springer-static/image/chp%3A10.1007%2F978-3-319-70139-4_84/MediaObjects/459893_1_En_84_Fig4_HTML.gif"/></p>
<p>实验方面, 数据集任然采用十分常见的CSIC 2010数据集, 按照7:0.5:2.5的比例划分数据集. 最后的Accuracy达到了百分之96.49</p>
<h2><a href=""></a></h2>
  </div>
  <div class="tag-cloud">
    <p>
    </p>
  </div>


  <div class="neighbors">
  </div>



</article>

    <footer>
<p>&copy; 2020 </p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " R08UST's Blog ",
  "url" : "",
  "image": "/images/profile/profile.jpg",
  "description": ""
}
</script>

    <script>
      $(document).ready(function() {
        $('#tipue_search_input').tipuesearch();
      });
    </script>

</body>
</html>